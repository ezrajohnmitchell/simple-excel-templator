{"version":3,"file":"js/app.c0e58fd1.js","mappings":";6BAAIA,oeCCJ,gnGAAAC,GAAA,wBAAAA,EAAA,sBAAAA,GAAA,iBAAAA,GAAA,ssDAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,4bAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,yhBAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,qGAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,w8BAAAA,EAAA,iBAAAA,EAAA,EAAAA,IAAA,EAAAA,GAAA,EAAAA,GAAA,qUAEA,IAAMC,EAAUC,EAAQ,MAID,aAyEtB,OAzEsB,cAAvB,4FAGwD,GADlDC,EAAeC,SAASC,eAAe,YAAYC,MAAM,GACzDC,EAAUH,SAASC,eAAe,QAAQC,MAAM,GAE/CH,EAAc,CAAF,eACoB,OAAnCK,EAAS,0BAA0B,6BAGhCD,EAAS,CAAF,eACoB,OAA9BC,EAAS,qBAAqB,0BAKO,OAAjCC,EAAW,IAAIR,EAAQS,SAAU,UACjCD,EAASE,KAAKC,KAAKC,EAAaV,IAAc,SAE9CW,EAAWL,EAASM,WAAW,KAEnCP,EAAS,oCAGLQ,EAAS,IAAIC,YAEZC,OAAS,SAACC,GACf,IAAMC,EAAOD,EAAEE,OAAOC,OAChBC,GAAMC,EAAAA,EAAAA,KAASJ,GAErB,GAAIG,EAAIE,QAAU,EAChBjB,EAAS,2BADX,CAKA,IAAMkB,EAAWC,OAAOC,KAAKL,EAAI,IAE3BM,EAAmB,IAAIC,IAE7BhB,EAASiB,SAAQ,SAACC,EAAKC,GACrBD,EAAIE,UAAS,SAACC,EAAMC,GACdV,EAASW,SAASF,EAAKG,QACzBT,EAAiBU,IAAIJ,EAAKG,MAAO,CAAEE,EAAGP,EAAQQ,EAAGL,GAErD,GACF,IAEA,IAAMM,EAAY,EAAIb,EAAiBD,QAGvCL,EAAIoB,SAAQ,SAACL,EAAOM,GAClB,IAAMC,EAAiBpC,EAASqC,eAEhCD,EAAeE,MAAQpB,OAAOqB,OAAOlC,EAASiC,MAAO,CACnDE,WAAYnC,EAASiC,MAAMG,SAE7BL,EAAeM,KAAO,IAAMP,EAAQ,GAEpCF,EAAUC,SAAQ,SAACS,GACjB,IAAIC,EAAMxB,EAAiByB,IAAIF,GAC/BP,EAAeU,QAAQF,EAAIb,EAAGa,EAAIZ,GAAGH,MAAQA,EAAMc,EACrD,GACF,IAGA3C,EAASE,KAAK6C,cAAcC,MAAK,SAACC,GAChC,IAAMC,EAAO,IAAIC,KAAK,CAACF,GAAS,CAC9BG,KAAM,qFAERC,EAAAA,EAAAA,QAAOH,EAAM,cACf,GArCA,CAsCF,EAEA3C,EAAO+C,WAAWxD,GAAS,6CAC5B,+BAEcM,EAAa,GAAD,4CAK1B,OAL0B,cAA3B,WAA4BmD,GAAI,uEAG5B,OAFIL,EAAO,IAAIC,KAAK,CAACI,GAAO,CAC5BH,KAAM,oFACN,SACWF,EAAKM,cAAa,oFAChC,sBAED,SAASzD,EAAS0D,GAChB,IAAIC,EAAQ/D,SAASC,eAAe,SACpC8D,EAAMC,MAAMC,QAAU,QACtBF,EAAMG,UAAYJ,CACpB,CAxFAK,OAAOC,SAAoB,WAEJ,kCCNnBC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUM,KAAKF,EAAOD,QAASC,EAAQA,EAAOD,QAASJ,GAGpEK,EAAOD,OACf,CAGAJ,EAAoBQ,EAAIF,EFzBpBjF,EAAW,GACf2E,EAAoBS,EAAI,SAAS7D,EAAQ8D,EAAUC,EAAIC,GACtD,IAAGF,EAAH,CAMA,IAAIG,EAAeC,IACnB,IAASxF,EAAI,EAAGA,EAAID,EAAS0B,OAAQzB,IAAK,CACrCoF,EAAWrF,EAASC,GAAG,GACvBqF,EAAKtF,EAASC,GAAG,GACjBsF,EAAWvF,EAASC,GAAG,GAE3B,IAJA,IAGIyF,GAAY,EACPC,EAAI,EAAGA,EAAIN,EAAS3D,OAAQiE,MACpB,EAAXJ,GAAsBC,GAAgBD,IAAa3D,OAAOC,KAAK8C,EAAoBS,GAAGQ,OAAM,SAASvC,GAAO,OAAOsB,EAAoBS,EAAE/B,GAAKgC,EAASM,GAAK,IAChKN,EAASQ,OAAOF,IAAK,IAErBD,GAAY,EACTH,EAAWC,IAAcA,EAAeD,IAG7C,GAAGG,EAAW,CACb1F,EAAS6F,OAAO5F,IAAK,GACrB,IAAI6F,EAAIR,SACER,IAANgB,IAAiBvE,EAASuE,EAC/B,CACD,CACA,OAAOvE,CArBP,CAJCgE,EAAWA,GAAY,EACvB,IAAI,IAAItF,EAAID,EAAS0B,OAAQzB,EAAI,GAAKD,EAASC,EAAI,GAAG,GAAKsF,EAAUtF,IAAKD,EAASC,GAAKD,EAASC,EAAI,GACrGD,EAASC,GAAK,CAACoF,EAAUC,EAAIC,EAwB/B,EG5BAZ,EAAoBoB,EAAI,SAASf,GAChC,IAAIgB,EAAShB,GAAUA,EAAOiB,WAC7B,WAAa,OAAOjB,EAAgB,OAAG,EACvC,WAAa,OAAOA,CAAQ,EAE7B,OADAL,EAAoBuB,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CACR,ECNArB,EAAoBuB,EAAI,SAASnB,EAASqB,GACzC,IAAI,IAAI/C,KAAO+C,EACXzB,EAAoB0B,EAAED,EAAY/C,KAASsB,EAAoB0B,EAAEtB,EAAS1B,IAC5EzB,OAAO0E,eAAevB,EAAS1B,EAAK,CAAEkD,YAAY,EAAMhD,IAAK6C,EAAW/C,IAG3E,ECPAsB,EAAoB6B,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAGhB,CAFE,MAAOvF,GACR,GAAsB,iBAAXoD,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBG,EAAoB0B,EAAI,SAASO,EAAKC,GAAQ,OAAOjF,OAAOkF,UAAUC,eAAe7B,KAAK0B,EAAKC,EAAO,aCKtG,IAAIG,EAAkB,CACrB,IAAK,GAaNrC,EAAoBS,EAAEO,EAAI,SAASsB,GAAW,OAAoC,IAA7BD,EAAgBC,EAAgB,EAGrF,IAAIC,EAAuB,SAASC,EAA4BC,GAC/D,IAKIxC,EAAUqC,EALV5B,EAAW+B,EAAK,GAChBC,EAAcD,EAAK,GACnBE,EAAUF,EAAK,GAGInH,EAAI,EAC3B,GAAGoF,EAASkC,MAAK,SAASC,GAAM,OAA+B,IAAxBR,EAAgBQ,EAAW,IAAI,CACrE,IAAI5C,KAAYyC,EACZ1C,EAAoB0B,EAAEgB,EAAazC,KACrCD,EAAoBQ,EAAEP,GAAYyC,EAAYzC,IAGhD,GAAG0C,EAAS,IAAI/F,EAAS+F,EAAQ3C,EAClC,CAEA,IADGwC,GAA4BA,EAA2BC,GACrDnH,EAAIoF,EAAS3D,OAAQzB,IACzBgH,EAAU5B,EAASpF,GAChB0E,EAAoB0B,EAAEW,EAAiBC,IAAYD,EAAgBC,IACrED,EAAgBC,GAAS,KAE1BD,EAAgBC,GAAW,EAE5B,OAAOtC,EAAoBS,EAAE7D,EAC9B,EAEIkG,EAAqBC,KAAwC,kCAAIA,KAAwC,mCAAK,GAClHD,EAAmB7E,QAAQsE,EAAqBS,KAAK,KAAM,IAC3DF,EAAmBG,KAAOV,EAAqBS,KAAK,KAAMF,EAAmBG,KAAKD,KAAKF,OC/CvF,IAAII,EAAsBlD,EAAoBS,OAAEN,EAAW,CAAC,MAAM,WAAa,OAAOH,EAAoB,KAAO,IACjHkD,EAAsBlD,EAAoBS,EAAEyC","sources":["webpack://Excel template filler/webpack/runtime/chunk loaded","webpack://Excel template filler/./src/scripts/index.js","webpack://Excel template filler/webpack/bootstrap","webpack://Excel template filler/webpack/runtime/compat get default export","webpack://Excel template filler/webpack/runtime/define property getters","webpack://Excel template filler/webpack/runtime/global","webpack://Excel template filler/webpack/runtime/hasOwnProperty shorthand","webpack://Excel template filler/webpack/runtime/jsonp chunk loading","webpack://Excel template filler/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","import \"../styles/index.scss\";\nimport { saveAs } from \"file-saver\";\nimport { csvParse } from \"d3\";\nconst ExcelJS = require(\"exceljs\");\n\nwindow.generate = generate;\n\nasync function generate() {\n  //validate\n  let templateFile = document.getElementById(\"template\").files[0];\n  let csvFile = document.getElementById(\"data\").files[0];\n\n  if (!templateFile) {\n    setError(\"*Must provide template\");\n    return;\n  }\n  if (!csvFile) {\n    setError(\"*Must provide csv\");\n    return;\n  }\n\n  // Read template file\n  const workbook = new ExcelJS.Workbook();\n  await workbook.xlsx.load(fileToBuffer(templateFile));\n\n  const template = workbook.worksheets[0];\n  if (!template) {\n    setError(\"*Must have at least 1 worksheet\");\n  }\n  //Read csv file\n  const reader = new FileReader();\n\n  reader.onload = (e) => {\n    const text = e.target.result;\n    const csv = csvParse(text);\n\n    if (csv.length <= 0) {\n      setError(\"*csv must have data\");\n      return;\n    }\n\n    const nameKeys = Object.keys(csv[0]);\n\n    const keytoTemplatePos = new Map();\n\n    template.eachRow((row, rowNum) => {\n      row.eachCell((cell, cellNum) => {\n        if (nameKeys.includes(cell.value)) {\n          keytoTemplatePos.set(cell.value, { x: rowNum, y: cellNum });\n        }\n      });\n    });\n\n    const validKeys = [...keytoTemplatePos.keys()];\n\n    //generate copies of template and fill with row data\n    csv.forEach((value, index) => {\n      const generatedSheet = workbook.addWorksheet();\n\n      generatedSheet.model = Object.assign(template.model, {\n        mergeCells: template.model.merges,\n      });\n      generatedSheet.name = \"\" + (index + 1);\n\n      validKeys.forEach((key) => {\n        let pos = keytoTemplatePos.get(key);\n        generatedSheet.getCell(pos.x, pos.y).value = value[key];\n      });\n    });\n\n    // download file\n    workbook.xlsx.writeBuffer().then((buffer) => {\n      const blob = new Blob([buffer], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8\",\n      });\n      saveAs(blob, \"output.xlsx\");\n    });\n  };\n\n  reader.readAsText(csvFile);\n}\n\nasync function fileToBuffer(file) {\n  const blob = new Blob([file], {\n    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8\",\n  });\n  return await blob.arrayBuffer();\n}\n\nfunction setError(message) {\n  let error = document.getElementById(\"error\");\n  error.style.display = \"block\";\n  error.innerHTML = message;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkExcel_template_filler\"] = self[\"webpackChunkExcel_template_filler\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [749], function() { return __webpack_require__(3211); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","i","ExcelJS","require","templateFile","document","getElementById","files","csvFile","setError","workbook","Workbook","xlsx","load","fileToBuffer","template","worksheets","reader","FileReader","onload","e","text","target","result","csv","csvParse","length","nameKeys","Object","keys","keytoTemplatePos","Map","eachRow","row","rowNum","eachCell","cell","cellNum","includes","value","set","x","y","validKeys","forEach","index","generatedSheet","addWorksheet","model","assign","mergeCells","merges","name","key","pos","get","getCell","writeBuffer","then","buffer","blob","Blob","type","saveAs","readAsText","file","arrayBuffer","message","error","style","display","innerHTML","window","generate","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","some","id","chunkLoadingGlobal","self","bind","push","__webpack_exports__"],"sourceRoot":""}